<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Lab Assistant Chat</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"> <!-- Font Awesome -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> <!-- Add marked library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.3/purify.min.js"></script>
    <script src="{{ url_for('static', filename='js/feedback.js') }}"></script>


    <script>
        marked.setOptions({
            breaks: true, // This will render line breaks in Markdown
            gfm: true,    // GitHub Flavored Markdown
        });
        console.log('Marked library loaded:', typeof marked);
        console.log('Markdown test:', marked.parse('# Hello\n\nThis is a **test**.'));
    </script>

</head>
<body>
    <!-- Include the navigation bar -->
    {% include 'navbar.html' %}

    <div class="container-fluid">
        <div class="row">
            {% if is_chat %}
                <div class="col-md-12 main-content">
                    <div class="d-flex flex-column align-items-center mb-3">
                        <h5>Are you having trouble?</h5>
                        <div class="subheader">Consider some of these frequently asked questions</div>
                        <div class="sample-questions">
                            <button class="btn btn-outline-primary m-1" onclick="handleSampleQuestion('Why can\'t my application connect to the MongoDB Cluster?')">Why can't my application connect to the MongoDB Cluster?</button>
                            <button class="btn btn-outline-primary m-1" onclick="handleSampleQuestion('Why is my library application displaying no data or books?')">Why is my library application displaying no data or books?</button>
                            <button class="btn btn-outline-primary m-1" onclick="handleSampleQuestion('Why is my github codespace not responding or launching the application properly?')">Why is my github codespace not responding or launching the application properly?</button>
                        </div>
                    </div>

                    <div class="chat-container" id="chat-container"></div>
                    <div class="input-container">
                        <div class="input-group">
                            <input type="text" class="form-control" id="user-input" placeholder="Ask a question...">
                            <button class="btn btn-primary" onclick="sendMessage()">Send</button>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="col-md-12 main-content">
                    <div class="home-page">
                        <h1>Welcome to the AI Lab Assistant</h1>
                        <p>
                            The AI Lab Assistant is designed to help you with commonly encountered issues while working on MongoDB projects. 
                            Whether you're having trouble connecting to your MongoDB cluster, displaying data in your application, or launching your GitHub codespace, 
                            the AI Lab Assistant is here to provide guidance and solutions.
                        </p>
                        <div class="container mt-5">
                            <div class="alert alert-info alert-dismissible fade show" role="alert" id="beta-note">
                                <strong>Note Regarding This Software:</strong> This system is in beta testing and may have bugs. If you encounter any issues, please notify your instructor.
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        </div>
                            <a href="{{ url_for('main.chat') }}" class="btn btn-primary">Start a Conversation</a></br>
                        </p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
    <div class="container mt-5" id="feedback-container">
        <button id="close-feedback" class="close-feedback-btn">&times;</button>
        <h2>We value your feedback!</h2>
        <p>Please rate your experience with our assistant:</p>
        <div id="feedback-scale" class="d-flex justify-content-center">
            <button class="feedback-button" data-value="1">üò°</button>
            <button class="feedback-button" data-value="2">üòü</button>
            <button class="feedback-button" data-value="3">üòê</button>
            <button class="feedback-button" data-value="4">üôÇ</button>
            <button class="feedback-button" data-value="5">üòç</button>
        </div>
        <p id="feedback-response" class="mt-3"></p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    

</body>
</html>
